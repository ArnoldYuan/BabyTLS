# BabyTLS
We implemented a simple simulative realization of the TLS process. Our implementation does not embrace the wildspreading format of certificates generated by OpenSSL. Instead, we desigened our own formats of certificates using RSA algorithm. The details of usage and design ideas are illustrated below.

## Usage
By default, the certificates for the server and root CA (who signed for the server) have already been generated. We provided a python package `utils` for certificate generation. Both the client and the server have a copy of the package. 

### Configuration
> If you are not interested in the details or don't need to customize the code, the part can be skipped for we have already generated everything for you.

We should first import the package.
```python
from utils import crypto
from utils import message
```

Create random RSA public key and private key pair.
```python
crypto.createKey('pubkeyServer', 'privkeyServer')
crypto.createKey('pubkeyCA', 'privkeyCA')
```
Create certificate for root CA. The root certificate is signed by itself (i.e. sign the public key with its private key).
```python
# saved as 'CERT_ROOT_CA'
crypto.createRootCert('pubkeyCA', 'privkeyCA')
```
Create certificate for the server. The server certificate is signed by and only by root CA in our implemenation.
```python
# saved as 'CERT_SERVER_CA'
crypto.createRootCert('pubkeyServer', 'privkeyServer')
```
Configure message types. There are seven types of messages in our implementation. Since this is a tiny realization of TLS process, there are fewer types than the original TLS process. The implemented message types are listed below. However, you can add your own message type in the `MessageType` enum class.
```python
class MessageType(Enum):
    CLIENT_HELLO = 0
    SERVER_HELLO = 1
    CERTIFICATE = 2
    SERVER_HELLO_DONE = 3
    CLIENT_KEY_EXCHANGE = 4
    FINISHED = 5
    DATA = 6
    # add your own type here
```
Also, you have to implement your message by extend the `Message` class and set the default values of `type` and `body`.
```python
@attr.s
class ServerHelloDone(Message):
    type = attr.ib(default=MessageType.YOUR_TYPE)
    body = attr.ib(default="default body")
```
To customize encryption algorithms, you can add a key-value pair in either `serverSuite.json` or `clientSuite.json`. Pay attention to the format. Three encryption algorithms will be used here.
```json
"new": {
        "name": "new",
        "handshake": "RSA",
        "data": "DES",
        "hash": "MD5"
    }
```
Till now, the set up has already been completed. 

### Server
Start the server.
```bash
python server/server.py
```

### Client
Start the client. (Make sure you have already started the server)
```bash
python client/client.py
```
To customize encryption suite and trusted CA:
```python
# line 13-14 in client.py
SUITE = "default"
trusted = ["CERT_ROOT_CA"]
```
To customize the meesage to send:
```python
# line 76 in client.py
self.communicate("TLS is not so difficult!")
```





